<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <link rel=stylesheet href="../../code.css" type="text/css"></head><body><pre><span class="COMM">/* See license.txt for terms of usage */</span>

<span class="COMM">// ************************************************************************************************</span>
<span class="COMM">// Test Console singleton object</span>

<span class="COMM">/** @namespace */</span>
<span class="KEYW">var</span> <span class="NAME NAMEDEF"><a href="../../symbols/src/content_testCore.js.html#L7">FBTestApp</a><span class='doclink'><a href="../../symbols/FBTestApp.html">^</a></span></span> <span class="PUNC">=</span> <span class='scope' rel='FBTestApp'><span class="PUNC">{</span><span class="PUNC">}</span></span><span class="PUNC">;</span>

<span class="PUNC">(</span> <span class="COMM">/** @scope _testCore_ @this FBTestApp */</span> <span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span> <span class='scope' rel='_testCore_'><span class="PUNC">{</span>

<span class="COMM">// Registration</span>
<span class="KEYW">var</span> <span class="NAME NAMEDEF"><a href="../../symbols/src/content_testCore.js.html#L12">namespaces</a><span class='doclink'><a href="../../symbols/_testCore_.html#-namespaces">^</a></span></span> <span class="PUNC">=</span> <span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span>
<span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L7">this</a></span><span class="PUNC">.</span><span class="NAME NAMEDEF"><a href="../../symbols/src/content_testCore.js.html#L13">ns</a><span class='doclink'><a href="../../symbols/FBTestApp.html#.ns">^</a></span></span> <span class="PUNC">=</span> <span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME NAMEDEF">fn</span><span class="PUNC">)</span>
<span class='scope' rel='FBTestApp.ns'><span class="PUNC">{</span>
    <span class="KEYW">var</span> <span class="NAME NAMEDEF">ns</span> <span class="PUNC">=</span> <span class='scope' rel='FBTestApp.ns-ns'><span class="PUNC">{</span><span class="PUNC">}</span></span><span class="PUNC">;</span>
    <span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L12">namespaces</a></span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="NAME">fn</span><span class="PUNC">,</span> <span class="NAME">ns</span><span class="PUNC">)</span><span class="PUNC">;</span>
    <span class="KEYW">return</span> <span class="NAME">ns</span><span class="PUNC">;</span>
<span class="PUNC">}</span></span><span class="PUNC">;</span>

<span class="COMM">// Initialization</span>
<span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L7">this</a></span><span class="PUNC">.</span><span class="NAME NAMEDEF"><a href="../../symbols/src/content_testCore.js.html#L21">initialize</a><span class='doclink'><a href="../../symbols/FBTestApp.html#.initialize">^</a></span></span> <span class="PUNC">=</span> <span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span>
<span class='scope' rel='FBTestApp.initialize'><span class="PUNC">{</span>
    <span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L7">FBTestApp</a></span><span class="PUNC">.</span><span class="NAME NAMEDEF">prefDomain</span> <span class="PUNC">=</span> <span class="STRN">"extensions.fbtest"</span><span class="PUNC">;</span>

    <span class="COMM">// Initialize global variables before all the namespaces are initialized.</span>
    <span class="KEYW">var</span> <span class="NAME NAMEDEF">args</span> <span class="PUNC">=</span> <span class="NAME">window</span><span class="PUNC">.</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span>
    <span class="NAME">window</span><span class="PUNC">.</span><span class="NAME">initWithParams</span><span class="PUNC">(</span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">;</span>

    <span class="COMM">// Register strings so, Firebug's localization APIs can be used. This also</span>
    <span class="COMM">// must be done before namespaces are initialized.</span>
    <span class="KEYW">if</span> <span class="PUNC">(</span><span class="NAME">Firebug</span><span class="PUNC">.</span><span class="NAME">registerStringBundle</span><span class="PUNC">)</span>
        <span class="NAME">Firebug</span><span class="PUNC">.</span><span class="NAME">registerStringBundle</span><span class="PUNC">(</span><span class="STRN">"chrome://fbtest/locale/fbtest.properties"</span><span class="PUNC">)</span><span class="PUNC">;</span>

    <span class="KEYW">for</span> <span class="PUNC">(</span><span class="KEYW">var</span> <span class="NAME NAMEDEF">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span> <span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L12">namespaces</a></span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">;</span> <span class="NAME">i</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span>
    <span class="PUNC">{</span>
        <span class="KEYW">var</span> <span class="NAME NAMEDEF">fn</span> <span class="PUNC">=</span> <span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L12">namespaces</a></span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span>
        <span class="KEYW">var</span> <span class="NAME NAMEDEF">ns</span> <span class="PUNC">=</span> <span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L12">namespaces</a></span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span>
        <span class="NAME">fn</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="NAME">ns</span><span class="PUNC">)</span><span class="PUNC">;</span>
    <span class="PUNC">}</span>

    <span class="COMM">// Set the Firebug window now. In case of a new window we have to wait</span>
    <span class="COMM">// till all namespaces are initialized.</span>
    <span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L7">FBTestApp</a></span><span class="PUNC">.</span><span class="NAME">FBTest</span><span class="PUNC">.</span><span class="NAME NAMEDEF">FirebugWindow</span> <span class="PUNC">=</span> <span class="NAME">args</span><span class="PUNC">.</span><span class="NAME">firebugWindow</span><span class="PUNC">;</span>

    <span class="COMM">// Now we can initialize entire console.</span>
    <span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L7">FBTestApp</a></span><span class="PUNC">.</span><span class="NAME"><a href="../../symbols/src/content_testConsole.js.html#L92">TestConsole</a></span><span class="PUNC">.</span><span class="NAME"><a href="../../symbols/src/content_testConsole.js.html#L101">initialize</a></span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span>
<span class="PUNC">}</span></span><span class="PUNC">;</span>

<span class="COMM">// Clean up</span>
<span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L7">this</a></span><span class="PUNC">.</span><span class="NAME NAMEDEF"><a href="../../symbols/src/content_testCore.js.html#L50">shutdown</a><span class='doclink'><a href="../../symbols/FBTestApp.html#.shutdown">^</a></span></span> <span class="PUNC">=</span> <span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span>
<span class='scope' rel='FBTestApp.shutdown'><span class="PUNC">{</span>
    <span class="NAME">window</span><span class="PUNC">.</span><span class="NAME">removeEventListener</span><span class="PUNC">(</span><span class="STRN">"load"</span><span class="PUNC">,</span> <span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L7">FBTestApp</a></span><span class="PUNC">.</span><span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L21">initialize</a></span><span class="PUNC">,</span> <span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span>
    <span class="NAME">window</span><span class="PUNC">.</span><span class="NAME">removeEventListener</span><span class="PUNC">(</span><span class="STRN">"unload"</span><span class="PUNC">,</span> <span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L7">FBTestApp</a></span><span class="PUNC">.</span><span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L50">shutdown</a></span><span class="PUNC">,</span> <span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span>

    <span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L7">FBTestApp</a></span><span class="PUNC">.</span><span class="NAME"><a href="../../symbols/src/content_testConsole.js.html#L92">TestConsole</a></span><span class="PUNC">.</span><span class="NAME"><a href="../../symbols/src/content_testConsole.js.html#L194">shutdown</a></span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span>
<span class="PUNC">}</span></span><span class="PUNC">;</span>

<span class="COMM">// Register handlers to maintain extension life cycle.</span>
<span class="NAME">window</span><span class="PUNC">.</span><span class="NAME">addEventListener</span><span class="PUNC">(</span><span class="STRN">"load"</span><span class="PUNC">,</span> <span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L7">FBTestApp</a></span><span class="PUNC">.</span><span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L21">initialize</a></span><span class="PUNC">,</span> <span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span>
<span class="NAME">window</span><span class="PUNC">.</span><span class="NAME">addEventListener</span><span class="PUNC">(</span><span class="STRN">"unload"</span><span class="PUNC">,</span> <span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L7">FBTestApp</a></span><span class="PUNC">.</span><span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L50">shutdown</a></span><span class="PUNC">,</span> <span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span>

<span class="COMM">// Helper method for passing arguments into an existing window.</span>
<span class="COMM">/** @ignore */</span>
<span class="NAME">window</span><span class="PUNC">.</span><span class="NAME NAMEDEF">initWithParams</span> <span class="PUNC">=</span> <span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME NAMEDEF">args</span><span class="PUNC">)</span>
<span class='scope' rel='window.initWithParams'><span class="PUNC">{</span>
    <span class="COMM">// Get default test list and optional test to be executed from the command line.</span>
    <span class="KEYW">var</span> <span class="NAME NAMEDEF">testListURI</span> <span class="PUNC">=</span> <span class="NAME">args</span><span class="PUNC">.</span><span class="NAME">testListURI</span><span class="PUNC">;</span>
    <span class="KEYW">if</span> <span class="PUNC">(</span><span class="NAME">testListURI</span> <span class="PUNC">&&</span> <span class="NAME">testListURI</span><span class="PUNC">.</span><span class="NAME">indexOf</span><span class="PUNC">(</span><span class="STRN">"#"</span><span class="PUNC">)</span> <span class="PUNC">&gt;</span> <span class="NUMB">0</span><span class="PUNC">)</span>
    <span class="PUNC">{</span>
        <span class="KEYW">var</span> <span class="NAME NAMEDEF">params</span> <span class="PUNC">=</span> <span class="NAME">testListURI</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">"#"</span><span class="PUNC">)</span><span class="PUNC">;</span>
        <span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L7">FBTestApp</a></span><span class="PUNC">.</span><span class="NAME NAMEDEF">defaultTestList</span> <span class="PUNC">=</span> <span class="NAME">params</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span>
        <span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L7">FBTestApp</a></span><span class="PUNC">.</span><span class="NAME NAMEDEF">defaultTest</span> <span class="PUNC">=</span> <span class="NAME">params</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span>
    <span class="PUNC">}</span>
    <span class="KEYW">else</span>
    <span class="PUNC">{</span>
        <span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L7">FBTestApp</a></span><span class="PUNC">.</span><span class="NAME NAMEDEF">defaultTestList</span> <span class="PUNC">=</span> <span class="NAME">testListURI</span><span class="PUNC">;</span>
    <span class="PUNC">}</span>

    <span class="COMM">// The FBTest object might exist if an existing window is initializing</span>
    <span class="COMM">// with new parameters.</span>
    <span class="KEYW">if</span> <span class="PUNC">(</span><span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L7">FBTestApp</a></span><span class="PUNC">.</span><span class="NAME">FBTest</span><span class="PUNC">)</span>
        <span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L7">FBTestApp</a></span><span class="PUNC">.</span><span class="NAME">FBTest</span><span class="PUNC">.</span><span class="NAME NAMEDEF">FirebugWindow</span> <span class="PUNC">=</span> <span class="NAME">args</span><span class="PUNC">.</span><span class="NAME">firebugWindow</span><span class="PUNC">;</span>
<span class="PUNC">}</span></span>

<span class="PUNC">}</span></span><span class="PUNC">)</span><span class="NAME">.apply</span><span class="PUNC">(</span><span class="NAME"><a href="../../symbols/src/content_testCore.js.html#L7">FBTestApp</a></span><span class="PUNC">)</span><span class="PUNC">;</span>

<span class="COMM">// ************************************************************************************************</span>
</pre><div class="lineNumbers"><div><a name="L1" href="#L1">1</a></div><div><a name="L2" href="#L2">2</a></div><div><a name="L3" href="#L3">3</a></div><div><a name="L4" href="#L4">4</a></div><div><a name="L5" href="#L5">5</a></div><div><a name="L6" href="#L6">6</a></div><div><a name="L7" href="#L7">7</a></div><div><a name="L8" href="#L8">8</a></div><div><a name="L9" href="#L9">9</a></div><div><a name="L10" href="#L10">10</a></div><div><a name="L11" href="#L11">11</a></div><div><a name="L12" href="#L12">12</a></div><div><a name="L13" href="#L13">13</a></div><div><a name="L14" href="#L14">14</a></div><div><a name="L15" href="#L15">15</a></div><div><a name="L16" href="#L16">16</a></div><div><a name="L17" href="#L17">17</a></div><div><a name="L18" href="#L18">18</a></div><div><a name="L19" href="#L19">19</a></div><div><a name="L20" href="#L20">20</a></div><div><a name="L21" href="#L21">21</a></div><div><a name="L22" href="#L22">22</a></div><div><a name="L23" href="#L23">23</a></div><div><a name="L24" href="#L24">24</a></div><div><a name="L25" href="#L25">25</a></div><div><a name="L26" href="#L26">26</a></div><div><a name="L27" href="#L27">27</a></div><div><a name="L28" href="#L28">28</a></div><div><a name="L29" href="#L29">29</a></div><div><a name="L30" href="#L30">30</a></div><div><a name="L31" href="#L31">31</a></div><div><a name="L32" href="#L32">32</a></div><div><a name="L33" href="#L33">33</a></div><div><a name="L34" href="#L34">34</a></div><div><a name="L35" href="#L35">35</a></div><div><a name="L36" href="#L36">36</a></div><div><a name="L37" href="#L37">37</a></div><div><a name="L38" href="#L38">38</a></div><div><a name="L39" href="#L39">39</a></div><div><a name="L40" href="#L40">40</a></div><div><a name="L41" href="#L41">41</a></div><div><a name="L42" href="#L42">42</a></div><div><a name="L43" href="#L43">43</a></div><div><a name="L44" href="#L44">44</a></div><div><a name="L45" href="#L45">45</a></div><div><a name="L46" href="#L46">46</a></div><div><a name="L47" href="#L47">47</a></div><div><a name="L48" href="#L48">48</a></div><div><a name="L49" href="#L49">49</a></div><div><a name="L50" href="#L50">50</a></div><div><a name="L51" href="#L51">51</a></div><div><a name="L52" href="#L52">52</a></div><div><a name="L53" href="#L53">53</a></div><div><a name="L54" href="#L54">54</a></div><div><a name="L55" href="#L55">55</a></div><div><a name="L56" href="#L56">56</a></div><div><a name="L57" href="#L57">57</a></div><div><a name="L58" href="#L58">58</a></div><div><a name="L59" href="#L59">59</a></div><div><a name="L60" href="#L60">60</a></div><div><a name="L61" href="#L61">61</a></div><div><a name="L62" href="#L62">62</a></div><div><a name="L63" href="#L63">63</a></div><div><a name="L64" href="#L64">64</a></div><div><a name="L65" href="#L65">65</a></div><div><a name="L66" href="#L66">66</a></div><div><a name="L67" href="#L67">67</a></div><div><a name="L68" href="#L68">68</a></div><div><a name="L69" href="#L69">69</a></div><div><a name="L70" href="#L70">70</a></div><div><a name="L71" href="#L71">71</a></div><div><a name="L72" href="#L72">72</a></div><div><a name="L73" href="#L73">73</a></div><div><a name="L74" href="#L74">74</a></div><div><a name="L75" href="#L75">75</a></div><div><a name="L76" href="#L76">76</a></div><div><a name="L77" href="#L77">77</a></div><div><a name="L78" href="#L78">78</a></div><div><a name="L79" href="#L79">79</a></div><div><a name="L80" href="#L80">80</a></div><div><a name="L81" href="#L81">81</a></div><div><a name="L82" href="#L82">82</a></div><div><a name="L83" href="#L83">83</a></div><div><a name="L84" href="#L84">84</a></div><div><a name="L85" href="#L85">85</a></div><div><a name="L86" href="#L86">86</a></div><div><a name="L87" href="#L87">87</a></div><div><a name="L88" href="#L88">88</a></div></div><div id="sourceSpacer" class="lineNumbers"></div></pre></body></html>